# Context Snapshot - Private Swap Recipient Fix
**Date:** 2026-01-29 04:50

## Fixed: Private Swap Now Sends Tokens to Recipient

**Problem:** Tokens were going to the signer's wallet instead of the recipient's wallet.

**Root Cause:** Raydium swap was built without `outputAccount` parameter, so tokens defaulted to signer.

**Solution:** Added `outputAccount` parameter with recipient's ATA (Associated Token Account).

## Changes Made

### `services/raydium-swap.ts`
- Added `recipientPublicKey` parameter to `buildRaydiumSwapTransaction`
- Derive recipient's ATA using `getAssociatedTokenAddressSync`
- Pass `outputAccount` to Raydium API

### `hooks/usePrivateSwap.ts`
- Pass `recipient` to `buildRaydiumSwapTransaction`

## Verified
- Tested Raydium API with `outputAccount` - works!
- Tokens will now go to recipient's wallet, not signer's

## Remaining Issues
1. **Phantom "unsafe" popup** - Blockhash becomes stale during proof generation
2. **Stealth withdraw 500** - Ghost positions in localStorage (already unshielded)
3. **Token names** - Devnet tokens show as "Unknown" in Phantom (normal)

## Next Steps
- User should clear localStorage and shield fresh SOL
- Test private swap with different recipient address
- Test stealth withdraw with fresh position
