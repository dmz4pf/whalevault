# Context Snapshot - WhaleVault V3 Planning (Final)
**Date:** 2026-01-27 11:30

## Status
- V3 implementation plan written: `docs/plans/2026-01-27-v3-implementation-plan.md`
- All design decisions finalized
- Next: Update PRD and architecture docs, then implementation

## V3 Scope (Final)
1. Supabase encrypted cloud backup (wallet_hash + encrypted blob)
2. Private Swap page (`/private-swap`) — any token via Jupiter
3. Stealth Withdraw (rename unshield + opt-in privacy delay 1h/6h/24h)
4. Transaction history page (`/history`)
5. Deposit receipt export/import
6. USDC "Coming Soon" disabled badge on shield page
7. UI enhancement — deferred to V3.1, but included in PRD/architecture

## All Design Decisions
- Auth: wallet signature (sign message → session)
- Secrets: client-side AES-256-GCM encryption, key from wallet signature
- Supabase schema: `vault_data(wallet_hash, encrypted_data, nonce, updated_at)` — wallet_hash is SHA-256 of pubkey
- Private Swap: own page + nav item, any token via Jupiter API, relayer-side swap
- Token list: top 5 featured + full Jupiter token list searchable
- Nav: Dashboard | Shield | Stealth Withdraw | Private Swap | History
- SPL shielding: SOL-only for V3, USDC card disabled with Coming Soon
- Privacy delay: opt-in toggle, presets 1h/6h/24h, client-side enforcement
- UI polish: deferred to V3.1

## Current Task
Updating PRD and architecture docs to reflect V2 reality + V3 additions
