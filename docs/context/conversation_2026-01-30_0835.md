# Context Snapshot - WhaleVault Wallet Connection Debug
**Date:** 2026-01-30 08:35
**Project:** WhaleVault Frontend

## Current Task
Debugging wallet connection issue after user cleared localStorage.

## Issue
- User cleared localStorage to clear shielded positions
- Now wallet won't connect
- Console shows: "Warning: Encountered two children with the same key, 'MetaMask'"
- Page shows "Connect your wallet to view your shielded positions"

## Root Cause Analysis
1. The duplicate key warning is from `@solana/wallet-adapter-react-ui` WalletModal
2. MetaMask appears twice in the wallet list (auto-detected + possibly duplicate adapter)
3. This is a React key warning, not a blocking error
4. Wallet connection should still work when clicking "Connect Wallet"

## Completed This Session (from prior context)
1. **Token-2022 Support** - Full implementation in backend
2. **Privacy delay** - Added to swap page
3. **Position pre-selection** - URL params + scroll animation
4. **Suspense fix** - Wrapped swap page for useSearchParams

## Files Involved
- `frontend/components/wallet/WalletProvider.tsx` - Wallet adapters config
- `frontend/components/wallet/ConnectButton.tsx` - Connect button UI
- `frontend/hooks/useWallet.ts` - Wallet state management

## Key Technical Details
- WalletProvider uses: PhantomWalletAdapter, SolflareWalletAdapter, TorusWalletAdapter
- `autoConnect` is enabled but won't work without stored wallet preference
- Wallet adapter stores `walletName` in localStorage for auto-connect

## Next Steps
1. Fix duplicate MetaMask key warning (cosmetic but noisy)
2. Verify wallet connection works when clicking "Connect Wallet" button
3. Test end-to-end flow after connection

## Relayer Wallet
`2rP2h5D28o3naqHNcND36zFkGQ5JBaouxG6fzgRjhvvC`
