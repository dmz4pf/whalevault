# Context Snapshot - WhaleVault Frontend
**Date:** 2026-01-29 10:55
**Context Usage:** 189.4%

## Current Task
Moving Privacy Level from shield to unshield flow, adding stealth address generation option.

## Key Decisions Made
- **Privacy Level at Unshield**: Delay timing chosen when unshielding, not when shielding
- **Stealth Addresses**: Option to generate one-time stealth address OR enter manual recipient
- **Three Unshield Actions**: Send Privately, Swap Privately, Back to My Wallet

## Implementation State
- [x] Removed PrivacyDelay from shield page
- [x] Added PrivacyDelay to unshield page (for send action)
- [x] TypeScript compiles
- [ ] Add stealth address generation option to recipient section
- [ ] Implement stealth address backend (Ed25519 ECDH)

## Files Modified This Session
- `frontend/app/shield/page.tsx` - Removed PrivacyDelay import and component
- `frontend/app/unshield/page.tsx` - Added PrivacyDelay, action selector
- `frontend/components/shield/PrivacyDelay.tsx` - Fixed intervals (Instant, 1h, 6h, 12h, 24h, Custom)

## Recipient Options (To Implement)
1. **Enter Address** - Manual wallet address input
2. **Generate Stealth** - One-time address using Ed25519 ECDH

## Stealth Address Flow
```
User has scanning keypair (stored client-side)
  ↓
Generate ephemeral keypair
  ↓
ECDH: shared_secret = ephemeral_private × scanning_public
  ↓
stealth_address = hash(shared_secret) → new keypair
  ↓
Publish ephemeral_public on-chain (or off-chain registry)
  ↓
Recipient scans: shared_secret = scanning_private × ephemeral_public
  ↓
Derives same stealth_address, can spend funds
```

## Next Steps
1. Add recipient type selector (Manual / Stealth)
2. Add "Generate Stealth Address" button with explanation
3. Backend: stealth address generation endpoint
4. Future: stealth address scanning/claiming

## Key Files
- `/frontend/app/unshield/page.tsx` - Main unshield flow
- `/frontend/components/shield/PrivacyDelay.tsx` - Timing selector
